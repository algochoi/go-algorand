name: Bench
on:
  # Push and update benchmarks when a commit is merged into master.
  push:
    branches:
      - cob-benchmarking
  # Trigger benchmark test on this PR's commit against master.
  pull_request:
    branches:
      - cob-benchmarking
jobs:
  test:
    name: Bench
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          go-version-file: 'go.mod'
      - run: go version
      - name: Build go-algorand
        run: scripts/travis/build.sh
    steps:

    - name: Set up Go 1.13
      uses: actions/setup-go@v1
      with:
        go-version: 1.13
      id: go

    - name: Check out code into the Go module directory
      uses: actions/checkout@v1

    - name: Install cob
      run: curl -sfL https://raw.githubusercontent.com/knqyf263/cob/master/install.sh | sudo sh -s -- -b /usr/local/bin

    - name: Run Benchmark
      run: cob -bench-args "test ./data/transactions/logic -bench BenchmarkUintMath"
